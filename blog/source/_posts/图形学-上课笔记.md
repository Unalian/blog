---
date: 2020/3/25
tags:
- 上课笔记
- 进程
categories:
- 游戏及图形学
- 图形学
---

# 第七章 光照模型s

重点

1. 光源
2. 基本光照模型（反射
3. 投射模型

## 7.1 光源

### 7.1.1 光源分类

**点光源 ** 适用于：比对象小的光源 离场景不是太近的大光源

**无穷远光源** 放射方向一致平行

### 7.1.2 辐射强度衰减（局部光源）

![辐射强弱衰减公式](https://img.cetacis.dev/uploads/big/1fdcfaa11d17849f9e9367fc6397b965.png)

用户可以调整系数a0，a1和a2的值以得到场景中不同的光照效果
<!-- more -->
### 7.1.3 方向光源和投射效果

方向光源 – 对象位于光源的方向范围𝜃𝑙 内才能得到光照

Vlight – 光源方向的单位向量

Vobj – 光源位置到一个对象位置 的方向向量

![](https://img.cetacis.dev/uploads/big/b6ec516eb1051a7df41c10720296fd3d.png)



![](https://img.cetacis.dev/uploads/big/c6694a745d69ebdfb354e2b28d2952a7.png)

### 7.1.4 角强度衰减

沿着圆锥轴光强最大，离开时强度减弱

方向光源角强度衰减函数: ($\alpha$l - 衰减指数)

![](https://img.cetacis.dev/uploads/big/1557b85bf8df80fe0734c2fb6ce94255.png)

## 7.2 基本光照模型（反射）

反射：漫反射 镜面反射

环境光：场景中各个表 面的反射光生成的光照效果

###  7.2.1 漫反射

理想漫反射体 – 入射光在各个方向以相 同强度发散而与观察者位置无关

#### 1.**朗伯余弦定理**

在与对象表面法向量夹角为𝜙𝑁 方向上，每个面积为dA的平面单位所 发散的光线与cos𝜙𝑁 成正比

#### 2. **漫反射系数**

假设每一表面都按照理想漫反射体对待，则可确定将要按漫反射 发散的入射光部分的每一个表面设定一个参数kd，该参数称为漫 反射系数

kd在0-1之间 强反射表面1.0 能吸收大部分入射光的表面 0

####3. **环境光漫反射**

I anbdiff = kd * Ia

Ia即背景光

#### 4. **光源漫反射**

当强度为Il的光源照射一个表面时，从该光 源来的入射光总量依赖于表面与光源的相对 方向

与表面相交的光线数量与该表面投影到入射 光方向的面积成正比

一个强度为I(l)的光源的入射光总量:

![光源漫反射](https://img.cetacis.dev/uploads/big/49c2b91638dbeee51cee963d81576792.png)

$cos\alpha$算法：N · L

![漫反射公式](https://img.cetacis.dev/uploads/big/4a9707ec9798e0699611e001c228453a.png)

向量L 的算法：

![向量L 的算法](https://img.cetacis.dev/uploads/big/537c02af96b767ae95dd840d89136d88.png)

### 7.2.2 镜面反射

镜面反射:在光滑表面上看到的 高光

镜面反射是由接近镜面反射角的 一个汇聚区域内，入射光的全部 或绝大部分成为反射光所导致的

理想的反射体 – V与R的夹角为0， 仅当V与R重合时才能观察到反 射光（一般考虑非理想）

#### 非理想反射体

 反射方向分布在向量R周围的有 限范围内

较光滑表面的镜面反射范围较小，粗糙的对象表面有较大的反射范 围

#### Phong 镜面反射模型

Phong镜面反射模型 – 镜面反射光强度与𝑐𝑜𝑠𝑛𝑠 𝜙成正比

![Phong镜面反射模型](https://img.cetacis.dev/uploads/big/8d7c8af4e669020b9b925a6c70ad1dd9.png)

Ns :镜面反射参数 由镜面表面材质决定，光滑ns打，粗糙ns小。

![](https://img.cetacis.dev/uploads/big/14c20471921ac45b6af7196439b04f17.png)

𝜙为V与R之间夹角 cos𝜙 = 𝑽 ∙ 𝑹 带入反射模型

![](https://img.cetacis.dev/uploads/big/72f787e580d4a578087689c90e909a93.png)

**R的计算方法：**

1. 精确计算

   ![](https://img.cetacis.dev/uploads/big/f48f8a7c00866196e501cf27b205b512.png)

2. 简便计算（有误差

![](https://img.cetacis.dev/uploads/big/c659311520ba265464c2b8dee7c84ab5.png)

若观察者与光源离对象表面足够远，且V与L均为常量，则面 上所有点的H也为常量

#### 漫反射镜面反射合并

![单点](https://img.cetacis.dev/uploads/big/5cc88b2d86fe9b8796c2ee8c447809c6.png)

![多点](https://img.cetacis.dev/uploads/big/69d338f3debaf5af31d42b40e5c40e25.png)

## 7.3 透射光

![](https://img.cetacis.dev/uploads/big/abebeaf3cbe28c8cc944353303806331.png)

Itrans是到达该点背后的光强

## 7.4全局光照光线跟踪法

全局光照算法

### 7.4.1 概念

从视点出发做经过图像平面上每个像素的光线并射回场景中，以此为基础计算表面的明暗效果

![](https://img.cetacis.dev/uploads/big/5c23bcbda93c41022d88aaff152b40f2.png)

跟踪光线在场景中的反射和折射，并且计算他们对光强的作用

### 7.4.2 优缺点

优点：真实 缺点：计算量大，视点/场景有变化就要重新计算

### 7.4.3 光线跟踪树

停止条件：无相交或者到达最大深度

![](https://img.cetacis.dev/uploads/big/00b4baf553f9e213b47de8d1f8bd3ab1.png)

### 7.4.4 求交计算

![](https://img.cetacis.dev/uploads/big/8423922f57f9c61fe1cd9b35f60182ba.png)

简化计算：

光线与多面体求交：多用包围盒求交。也可以多层包围球减少计算量

空间分割法：立方体分割

## 7.5 纹理

### 7.5.1 纹理映射

**概念** 纹 理模式映射到对象表面上

**种类** 2d 3d

#### 2d映射

1. 平面映射

   将某坐标抛弃，其余两个定位一张素材图

2. 圆柱体包裹

   用一个形状将物体包裹

3. 球体包裹

4. 盒状素材

#### 3d映射

通过点(x,y,z)直接计算纹理颜色，不再使用map shape。即使用函数。

### 7.5.2 凹凸映射

凹凸映射 – 使用扰动函数并在光照模型计算中使用扰动法向量；

通过修改物体表面法向量来 影响表面阴影的计算

令P(u,v)表示一个参数曲面上的点 N = Pu X Pv （关于u,v的偏导数

增加一个小的扰动函数(凹凸函数)b，在表面法向量𝑛 = 𝑵 |𝑵|方向上增加凹凸效果:

P'（u,v） =  P（u,v）+ b(u,v)n

# 第八章 关节动画

1. 层次结构建模
2. 正向运动学
3. 逆向运动学

## 8.1 层次结构建模

### 8.1.1 基本概念

关节 如果两个刚体互相连接且能够发生相对运动，则这两个刚 体的关联部分称为关节（=旋转关节 滑动关节）

关节链 – 将一系列一次相连的刚体通过关节连接而成的开链

链杆 – 关节链中每一段刚体

基结点 – 关节链的起点

末端影响器 – 关节链的自由末端(End effector)

关节链结构的自由度 – 完全确定关节链结构状态所需的独立变量 个数

状态空间： 所有可能的空间

状态向量：状态空间中的向量

关节链结构的自由度 – 完全确定关节链结构状态所需的独立变量 个数

### 8.1.2 基于层次建模的数据结构

•弧线–关节  •节点–链接杆

### 8.1.3 正向运动学

